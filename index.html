<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <canvas id="myCanvas" width="420px" height="420px" style="border: 2px solid black;"></canvas><br>
    <button id="reset" style="padding: 10px;">reset</button>

    <script>

        const c = document.getElementById("myCanvas");
        const resetBtn = document.getElementById("reset");
        const ctx = c.getContext("2d");

        const table = ['','','','','','','','',''];

        let turn = 'X' ;

        let canClick = true;

        function turnChange() {

            // console.log(turn);

            if (turn == 'X') {

                turn = 'O';

            }else {

                turn = 'X';

            }

        }

        function draw(x,y) {

            if(turn == 'O') {

                console.log('yes');

                ctx.beginPath();
                ctx.arc(x,y,50,0,2*Math.PI);
                ctx.stroke();

            }else {

                ctx.beginPath();
                ctx.moveTo(x-30,y-30);
                ctx.lineTo(x+30,y+30);

                ctx.moveTo(x+30,y-30);
                ctx.lineTo(x-30,y+30);

                ctx.stroke();

            }

        }

        function positionCheck(x,y) {
            
            

            // table[0]

            if( x >= 0 && x <= 140 && y >= 0 && y <= 140 && table[0] == ''){

                table[0] = turn;
                draw(70,70);
                
                turnChange();

            }

            //table[1]

            if( x >= 180 && x <= 280 && y >= 0 && y <= 140 && table[1] == ''){

                table[1] = turn;
                draw(210,70);
                
                turnChange();

            }

            //table[2]

            if( x >= 280 && x <= 400 && y >= 0 && y <= 140 && table[2] == ''){

                table[2] = turn;
                draw(350,70);
                
                turnChange();

            }

            //table[3]

            if( x >= 0 && x <= 140 && y >= 140 && y <= 280 && table[3] == ''){

                table[3] = turn;
                draw(70,210);
                
                turnChange();

            }
            
            //table[4]

            if( x >= 140 && x <= 280 && y >= 140 && y <= 280 && table[4] == ''){

                table[4] = turn;
                draw(210,210);
                
                turnChange();

            }
            //table[5]

            if( x >= 280 && x <= 420 && y >= 140 && y <= 280 && table[5] == ''){

                table[5] = turn;
                draw(350,210);
                
                turnChange();

            }
            //table[6]

            if( x >= 0 && x <= 140 && y >= 280 && y <= 420 && table[6] == ''){

                table[6] = turn;
                draw(70,350);
                
                turnChange();

            }

            //table[7]

            if( x >= 140 && x <= 280 && y >= 280 && y <= 420 && table[7] == ''){

                table[7] = turn;
                draw(210,350);
                
                turnChange();

            }

            //table[8]

            if( x >= 280 && x <= 420 && y >= 280 && y <= 420 && table[8] == ''){

                table[8] = turn;
                draw(350,350);
                
                turnChange();

            }

           isWin(winCheck());

        }

        function winCheck() {

            // X ชนะ

            // แนวนอน
            if(table[0] == 'X' && table[1] == 'X' && table[2] == 'X'){

                return true

            }else if(table[3] == 'X' && table[4] == 'X' && table[5] == 'X'){

                return true

            }else if(table[6] == 'X' && table[7] == 'X' && table[8] == 'X'){

                return true
            
            // แนวตั้ง
            }else if(table[0] == 'X' && table[3] == 'X' && table[6] == 'X'){

                return true

            }else if(table[1] == 'X' && table[4] == 'X' && table[7] == 'X'){

                return true

            }else if(table[2] == 'X' && table[5] == 'X' && table[8] == 'X'){

                return true

            // แนวเฉียง

            }else if(table[0] == 'X' && table[4] == 'X' && table[8] == 'X'){

                return true

            }else if(table[2] == 'X' && table[4] == 'X' && table[6] == 'X'){

                return true

            }

            // O ชนะ

            // แนวนอน
            if(table[0] == 'O' && table[1] == 'O' && table[2] == 'O'){

                return true

            }else if(table[3] == 'O' && table[4] == 'O' && table[5] == 'O'){

                return true

            }else if(table[6] == 'O' && table[7] == 'O' && table[8] == 'O'){

                return true
            
            // แนวตั้ง
            }else if(table[0] == 'O' && table[3] == 'O' && table[6] == 'O'){

                return true

            }else if(table[1] == 'O' && table[4] == 'O' && table[7] == 'O'){

                return true

            }else if(table[2] == 'O' && table[5] == 'O' && table[8] == 'O'){

                return true

            // แนวเฉียง

            }else if(table[0] == 'O' && table[4] == 'O' && table[8] == 'O'){

                return true

            }else if(table[2] == 'O' && table[4] == 'O' && table[6] == 'O'){

                return true

            }

            
        }

        function isWin(winValue) {

            if (winValue) {

                turnChange();
                alert(turn + " wins");
                canClick = false;
            }

        }

        function setup() {

            ctx.beginPath();
            ctx.moveTo(140,0);
            ctx.lineTo(140,420);

            ctx.moveTo(280,0);
            ctx.lineTo(280,420);

            ctx.moveTo(0,140);
            ctx.lineTo(420,140);

            ctx.moveTo(0,280);
            ctx.lineTo(420,280);
            
            ctx.stroke();

        }

        setup();

        c.addEventListener("click", function(e) {

            if(canClick) {

                let x = e.offsetX;
                let y = e.offsetY;

                console.log(table);

                positionCheck(x,y);

            }

        });

        resetBtn.addEventListener("click",function() {

            ctx.clearRect(0,0,c.width,c.height);
            setup();
            table.fill('');
            canClick = true

        });
        
        
    </script>
</body>
</html>